<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Traffic Prediction Demo</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-6">

<div class="max-w-4xl mx-auto bg-white p-6 rounded-xl shadow">
    <h1 class="text-3xl font-bold mb-4 text-center">Traffic Prediction Demo</h1>

    <!-- Upload Form -->
    <form method="POST" enctype="multipart/form-data" class="mb-6">
        <label class="block mb-2 font-semibold">Upload image(s):</label>
        <input type="file" name="images" multiple
               class="border p-2 w-full mb-4 rounded">

        <button type="submit"
                class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
            Predict Traffic
        </button>
    </form>

    {% if results %}
    <h2 class="text-2xl font-semibold mb-4">Prediction Results</h2>

    <div class="space-y-8">
        {% for r in results %}
        <div class="border p-4 rounded shadow bg-gray-50">

            <h3 class="text-xl font-bold mb-2">{{ r.filename }}</h3>

            <div class="flex space-x-4">
                <a href="{{ r.path }}" target="_blank">
                    <img src="{{ r.path }}" alt="" class="w-64 rounded border object-contain cursor-pointer"/>
                </a>

                <div class="flex-1">
                    <p class="text-lg">
                        <span class="font-semibold">Prediction:</span>
                        <span class="px-2 py-1 rounded text-white
                            {% if r.label == 'free_flow' %} bg-green-600
                            {% elif r.label == 'moderate' %} bg-yellow-600
                            {% else %} bg-red-600 {% endif %}">
                            {{ r.label }}
                        </span>
                    </p>

                    <h4 class="mt-4 font-semibold">Extracted Features:</h4>
                    <ul class="list-disc ml-6">
                        {% for k, v in r.features.items() %}
                        <li>{{ k }}: {{ v }}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>

        </div>
        {% endfor %}
    </div>

    <!-- Decision Tree Image -->
    <div class="mt-10">
        <h3 class="text-xl font-semibold mb-2">Decision Tree</h3>
        <img src="/static/uploads/decision_tree.png" alt="" class="border rounded shadow"/>
    </div>

    <!-- Charts -->
    <div class="mt-10">
        <h3 class="text-xl font-semibold mb-2">Confusion Matrix</h3>
        <img src="/static/uploads/confusion_matrix.png" alt="" class="border rounded shadow"/>
    </div>
    <div class="mt-10">
        <h3 class="text-xl font-semibold mb-2">Classification Report</h3>
        <img src="/static/uploads/classification_report.png" alt="" class="border rounded shadow"/>
    </div>

    {% endif %}

</div>

</body>
</html>
